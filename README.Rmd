---
output: 
  github_document:
    toc: false
    fig_width: 10.08
    fig_height: 6
tags: [r, bayesian, posterior, test]
vignette: >
  %\VignetteIndexEntry{README}
  \usepackage[utf8]{inputenc}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

# bayestestR <img src='man/figures/logo.svg' align="right" height="139" />

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  fig.path = "README-"
)
```


[![Build Status](https://travis-ci.org/DominiqueMakowski/bayestestR.svg?branch=master)](https://travis-ci.org/DominiqueMakowski/bayestestR)
[![codecov](https://codecov.io/gh/DominiqueMakowski/bayestestR/branch/master/graph/badge.svg)](https://codecov.io/gh/DominiqueMakowski/bayestestR)
[![HitCount](http://hits.dwyl.io/DominiqueMakowski/bayestestR.svg)](http://hits.dwyl.io/DominiqueMakowski/bayestestR)
<!-- Add this to the README manually! -->
<!-- [![Documentation](https://img.shields.io/badge/documentation-bayestestR-orange.svg?colorB=E91E63)](https://dominiquemakowski.github.io/bayestestR/) -->






```{r eval=FALSE, message=FALSE, warning=FALSE, echo=FALSE}
# Create logo
library(ggplot2)
library(dplyr)
library(hexSticker)
library(bayestestR)

set.seed(333)

posterior <- rnorm_perfect(1000, 2, 1)


p <- posterior %>% 
  density() %>% 
  as.data.frame() %>% 
  mutate(fill = ifelse(x > hdi(posterior, 75)[2], "sup", "hdi"),
         fill = ifelse(x < hdi(posterior, 75)[1], "inf", fill),
         fill = ifelse(x < 0, "p", fill)) %>% 
  ggplot(aes(x=x, y=y)) +
  geom_ribbon(aes(ymin=0, ymax=y, fill=fill)) +
  scale_fill_manual(values=c("p"="#E91E63", "inf"="#FF9800", "hdi"="#FFC107", "sup"="#FF9800"), guide=FALSE) +
  geom_vline(xintercept=0, linetype="dotted", size=0.1) +
  # geom_segment(x=map_estimate(posterior)[1], xend=map_estimate(posterior)[1],
  #              y=0, yend=map_estimate(posterior)[2], size=0.25, color="#E91E63") +
  geom_line(size=0.35) +
  theme_void() + 
  theme_transparent() +
  scale_y_continuous(expand = c(0, 0.002))
p

s <- hexSticker::sticker(p, package="bayestestR", 
                    # p_size=8, 
                    s_x=1,
                    # s_y=.75,
                    s_width=1.2, 
                    s_height=0.8,
                    h_fill="#FFC107", 
                    h_color="#E91E63",
                    filename="../logo.svg")
s
```


`bayestestR` is a lightweight package providing utilities to describe posterior distributions and Bayesian models.


## Installation


Run the following:

```{r eval=FALSE, message=FALSE, warning=FALSE}
install.packages("devtools")
devtools::install_github("DominiqueMakowski/bayestestR")
```
```{r message=FALSE, warning=FALSE}
library("bayestestR")
```



# Functions

Check out the [**documentation**](https://dominiquemakowski.github.io/bayestestR/)!

## Posterior Description

### HDI

**`hdi()`** computes the Highest Density Interval (HDI) of a posterior distribution, i.e., the interval which contains all points within the interval have a higher probability density than points outside the interval. The HDI is used in the context of Bayesian posterior characterisation as Credible Interval (CI).

```{r message=FALSE, warning=FALSE, results='hide'}
hdi(posterior = rnorm(1000), CI = 90)
```

![](https://dominiquemakowski.github.io/bayestestR/articles/IndicesDescription_files/figure-html/unnamed-chunk-3-1.png)
###  MAP estimate

**`map_estimate()`** finds the Highest Maximum A Posteriori (MAP) estimate of a posterior. It corresponds to the 'peak' of the posterior distribution.

```{r message=FALSE, warning=FALSE, results='hide'}
map_estimate(rnorm(1000, 1, 1))
```

![](https://dominiquemakowski.github.io/bayestestR/articles/IndicesDescription_files/figure-html/unnamed-chunk-5-1.png)


### ROPE

**`rope()`** computes the proportion of the HDI of a posterior distribution that lies within a region of practical equivalence. Statistically, the probability of a posterior distribution of being different from 0 does not make much sense (the probability of it being different from a single point being infinite). Therefore, the idea underlining ROPE is to let the user define an area around the null value enclosing values that are equivalent to the null value for practical purposes (2010, 2011, 2014). Kruschke (2018) suggests that such null value could be set, by default, to the -0.1 to 0.1 range of a standardized parameter (negligible effect size according to Cohen). This could be generalized: For instance, for linear models, the ROPE could be set as 0 +/- .1 \* sd(y). Kruschke (2010, 2011, 2014) suggest using the proportion of the 95\% (or 90\%, considered more stable) *HDI* that falls within the ROPE as an index for "null-hypothesis" testing (as understood under the Bayesian framework, see `rope_test`). Besides the ROPE-based decisions criteria, the proportion of the 95\% CI that falls in the ROPE can be used as a continuous index.

```{r message=FALSE, warning=FALSE, results='hide'}
rope(posterior = rnorm(1000, 1, 1), bounds = c(-0.1, 0.1))
```


![](https://dominiquemakowski.github.io/bayestestR/articles/IndicesDescription_files/figure-html/unnamed-chunk-7-1.png)

## Null-Hypothesis Significance Testing (NHST)

### ROPE-based test

**`rope_test()`** performs a Test for Practical Equivalence based on the "HDI+ROPE decision rule" (Kruschke 2018) to check whether parameter values should be accepted or rejected against an explicitely formulated "null hypothesis".

```{r message=FALSE, warning=FALSE, results='hide'}
rope_test(posterior = rnorm(1000, 1, 1), bounds = c(-0.1, 0.1))
```


### ROPE-based probability

**`p_rope()`** computes the ROPE-based p-value that represents the maximum Credible Interval (HDI) that does not contain (positive values) or is entirely contained (negative values) in the negligible values space defined by the ROPE. A ROPE-based p of 97% means that there is a probability of .97 that a parameter (desccribed by its posterior distribution) is outside the ROPE.

```{r message=FALSE, warning=FALSE, results='hide'}
p_rope(posterior = rnorm(1000, 1, 1), bounds = c(-0.1, 0.1))
```

### Probability of Direction (*p*d)

**`p_direction()`** computes the Probability of Direction (p, also known as the Maximum Probability of Effect - MPE), a Bayesian equivalent of the p-value (altough differently expressed). It varies between 50\% and 100\% and can be interpreted as the probability that a parameter (described by its posterior distribution) is positive or negative (following  the median's sign). It is defined as the proportion of the posterior distribution of the median's sign. It is used as an index of effect existence, i.e., whether the probability that the effect is in the same direction than the point-estimate (independently of the effect's size or significance). This p-value is fairly similar to its frequentist counterpart (i.e., is strongly correlated).

```{r message=FALSE, warning=FALSE, results='hide'}
p_direction(rnorm(1000, mean = 1, sd = 1))
```

![](https://dominiquemakowski.github.io/bayestestR/articles/IndicesDescription_files/figure-html/unnamed-chunk-11-1.png)

### MAP-based *p*-value

**`p_map()`** computes a Bayesian equivalent of the p-value, related to the odds that a parameter (described by its posterior distribution) has againt the null hypothesis (h0) using Mills' (2014, 2017) Objective Bayesian Hypothesis Testing paradigm. It is mathematically based on the density at the Maximum A Priori (MAP). It correponds to the density value at 0 divided by the density of the highest density point.

```{r message=FALSE, warning=FALSE, results='hide'}
p_map(posterior = rnorm(1000, 1, 1))
```

![](https://dominiquemakowski.github.io/bayestestR/articles/IndicesDescription_files/figure-html/unnamed-chunk-13-1.png)


## Utilities

### Perfect Normal Distribution

**`rnorm_perfect()`**: Generate a sample of size n with a near-perfect normal distribution.

```{r message=FALSE, warning=FALSE, results='hide'}
rnorm_perfect(n = 10)
```

### Probability of a Value

**`density_at()`**: Compute the density of a given point of a distribution.

```{r message=FALSE, warning=FALSE, results='hide'}
density_at(posterior = rnorm(1000, 1, 1))
```




## Credits

You can cite the package as following:

- Makowski, (2019). *Understand and Describe Bayesian Models and Posterior Distributions using BayestestR*. CRAN. doi: .


Please remember that parts of the code in this package was inspired / shamelessly copied from other great packages that you must check out and cite, such as [sjstats](https://github.com/strengejacke/sjstats) or [BayesTesting.jl](https://github.com/tszanalytics/BayesTesting.jl). All credits go to their authors.